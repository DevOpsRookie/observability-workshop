



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Splunk App Dev Workshop">
      
      
        <link rel="canonical" href="https://signalfx.github.io/app-dev-workshop/module1/k3s/">
      
      
        <meta name="author" content="Sales Engineering">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>Deploying the Smart Agent in Kubernetes (K3s) - App Dev Workshop</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#lab-summary" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://signalfx.github.io/app-dev-workshop/" title="App Dev Workshop" aria-label="App Dev Workshop" class="md-header-nav__button md-logo">
          
            <img alt="logo" src="../../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              App Dev Workshop
            </span>
            <span class="md-header-nav__topic">
              
                Deploying the Smart Agent in Kubernetes (K3s)
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/signalfx/app-dev-workshop/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://signalfx.github.io/app-dev-workshop/" title="App Dev Workshop" class="md-nav__button md-logo">
      
        <img alt="logo" src="../../images/logo.png" width="48" height="48">
      
    </a>
    App Dev Workshop
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/signalfx/app-dev-workshop/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      <b>Module 1</b> - Dashboards
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <b>Module 1</b> - Dashboards
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../dashboards/" title="Working with Dashboards, Charts and Metrics" class="md-nav__link">
      Working with Dashboards, Charts and Metrics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      <b>Module 2</b> - Detectors
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <b>Module 2</b> - Detectors
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../detectors/" title="Working with Detectors" class="md-nav__link">
      Working with Detectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../muting/" title="Working with Muting Rules" class="md-nav__link">
      Working with Muting Rules
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      <b>Module 3</b> - Smart Agent
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <b>Module 3</b> - Smart Agent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Deploying the Smart Agent in Kubernetes (K3s)
      </label>
    
    <a href="./" title="Deploying the Smart Agent in Kubernetes (K3s)" class="md-nav__link md-nav__link--active">
      Deploying the Smart Agent in Kubernetes (K3s)
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-summary" class="md-nav__link">
    Lab Summary
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-lets-bake-some-k8s" class="md-nav__link">
    1. Let’s bake some K8s
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ive-got-the-key-ive-got-the-secret" class="md-nav__link">
    2. I’ve got the key, I’ve got the secret!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-take-the-helm" class="md-nav__link">
    3. Take the Helm!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-check-all-is-well-in-the-signalfx-ui" class="md-nav__link">
    4. Check all is well in the SignalFx UI!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../nginx/" title="Deploying NGINX in K3s" class="md-nav__link">
      Deploying NGINX in K3s
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      <b>Module 4</b> - Monitoring as Code
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <b>Module 4</b> - Monitoring as Code
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../terraform/" title="Using Terraform for charts and dashboards" class="md-nav__link">
      Using Terraform for charts and dashboards
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      <b>Module 5</b> - Service Bureau
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <b>Module 5</b> - Service Bureau
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../service_bureau/" title="Billing and Usage" class="md-nav__link">
      Billing and Usage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../teams/" title="Teams" class="md-nav__link">
      Teams
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      <b>Module 6</b> - µAPM
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <b>Module 6</b> - µAPM
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../module2/hotrod/" title="Running Hotrod in K3s" class="md-nav__link">
      Running Hotrod in K3s
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../module2/sockshop/" title="Running Sock Shop in K3s" class="md-nav__link">
      Running Sock Shop in K3s
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../cleanup/" title="Cleaning Up!" class="md-nav__link">
      Cleaning Up!
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lab-summary" class="md-nav__link">
    Lab Summary
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-lets-bake-some-k8s" class="md-nav__link">
    1. Let’s bake some K8s
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-ive-got-the-key-ive-got-the-secret" class="md-nav__link">
    2. I’ve got the key, I’ve got the secret!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-take-the-helm" class="md-nav__link">
    3. Take the Helm!
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-check-all-is-well-in-the-signalfx-ui" class="md-nav__link">
    4. Check all is well in the SignalFx UI!
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/signalfx/app-dev-workshop/edit/master/docs/modules/module1/k3s.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Deploying the Smart Agent in Kubernetes (K3s)</h1>
                
                <h2 id="lab-summary">Lab Summary<a class="headerlink" href="#lab-summary" title="Permanent link">&para;</a></h2>
<ul>
<li>Download the workshop and configure Kubernetes (<a href="https://k3s.io/">K3s</a>) environment.</li>
<li>Use the SignalFx Helm chart to install the Smart Agent in K3s.</li>
<li>Explore Your cluster in the Kubernetes Navigator</li>
</ul>
<p>If you have chosen to run the workshop on a AWS/EC2 instance, please follow instructions and go to <a href="http://127.0.0.1:8000/module1/k3s/#2-ive-got-the-key-ive-got-the-secret">Step 2</a>.</p>
<hr />
<h3 id="1-lets-bake-some-k8s">1. Let’s bake some K8s<a class="headerlink" href="#1-lets-bake-some-k8s" title="Permanent link">&para;</a></h3>
<p>Install <a href="https://multipass.run/">Multipass</a> for your OS. On a Mac you can also install via <code>brew</code> e.g. <code>brew cask install multipass</code></p>
<p>Download the App Dev Workshop master zip file, unzip the file and change into the app-dev-workshop-master directory</p>
<div class="codehilite"><pre><span></span><code>curl -LO https://github.com/signalfx/app-dev-workshop/archive/master.zip
unzip master.zip
<span class="nb">cd</span> app-dev-workshop-master
</code></pre></div>

<p>Launch the Multipass instance which will run Kubernetes. <strong>Note:</strong> Use <code>{YOUR_INITIALS}-k3s</code> this is so the value of the instance hostname is unique e.g. <code>rwc-k3s</code></p>
<div class="codehilite"><pre><span></span><code>multipass launch --name <span class="o">{</span>YOUR_INITIALS<span class="o">}</span>-k3s --cloud-init cloud-init-k3s.yaml --cpus<span class="o">=</span><span class="m">2</span> --mem<span class="o">=</span>2G
</code></pre></div>

<p>Once the instance has been successfully created shell into it.</p>
<div class="codehilite"><pre><span></span><code>multipass shell <span class="o">{</span>YOUR_INITIALS<span class="o">}</span>-k3s
</code></pre></div>

<hr />
<h3 id="2-ive-got-the-key-ive-got-the-secret">2. I’ve got the key, I’ve got the secret!<a class="headerlink" href="#2-ive-got-the-key-ive-got-the-secret" title="Permanent link">&para;</a></h3>
<p>You will need to obtain your Access Token from the SignalFx UI once Kubernetes is running. You can find your Access Token by clicking on your profile icon on the top right of the SignalFx UI. Then select <em><strong>Organisation Settings → Access Tokens</strong></em>.  Expand the Default token, then click on <em><strong>Show Token</strong></em> to expose your token. Later in the lab you can come back here and click the <em><strong>Copy</strong></em> button which will copy it to your clipboard  so you can paste it when you need to provide an access token in the lab.
<img alt="Access Token" src="../../images/m1-l4-access-token.png" /></p>
<p>You will also need to obtain the name of the Realm for your SignalFx account.  Click on the profile icon again, but this time select 'My Profile'.  The Ream can be found in the middle of the page within the Organizations section.  In this example it is <code>us1</code>.
<img alt="Realm" src="../../images/m1-l4-realm.png" /></p>
<hr />
<h3 id="3-take-the-helm">3. Take the Helm!<a class="headerlink" href="#3-take-the-helm" title="Permanent link">&para;</a></h3>
<p>Create the following variables to use in the proceeding helm install command:</p>
<div class="codehilite"><pre><span></span><code>export ACCESS_TOKEN=&lt;token from Step 2&gt;
export REALM=&lt;realm from Step 2&gt;
export INITIALS=&lt;your initials e.g. GXH&gt;
export VERSION=&lt;Smart Agent version e.g. 5.0.4&gt;
</code></pre></div>

<p><strong>Note:</strong> The latest version of the Smart Agent can be found on <a href="https://github.com/signalfx/signalfx-agent/releases">GitHub</a></p>
<p>Install the agent using the SignalFx Helm chart. Firstly, add the SignalFx Helm chart repository to Helm.</p>
<div class="codehilite"><pre><span></span><code>helm repo add signalfx https://dl.signalfx.com/helm-repo
</code></pre></div>

<p>Ensure the latest state of the SignalFx Helm repository</p>
<div class="codehilite"><pre><span></span><code>helm repo update
</code></pre></div>

<p>Install the Smart Agent Helmchart with the following commands:</p>
<div class="codehilite"><pre><span></span><code>sed -i -e &#39;s/\[INITIALS\]/&#39;&quot;$INITIALS&quot;&#39;/&#39; workshop/k3s/values.yaml
helm install --set signalFxAccessToken=$ACCESS_TOKEN --set clusterName=$INITIALS-SFX-WORKSHOP --set kubeletAPI.url=https://localhost:10250  --set signalFxRealm=$REALM  --set agentVersion=$VERSION --set traceEndpointUrl=https://ingest.$REALM.signalfx.com/v2/trace --set gatherDockerMetrics=false signalfx-agent signalfx/signalfx-agent -f workshop/k3s/values.yaml
</code></pre></div>

<p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report a new pod is up and running after about 30 seconds. Ensure the status is reported as Running before continuing.</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Input</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><code>kubectl get pods
</code></pre></div></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Output</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><code>NAME                   READY   STATUS    RESTARTS   AGE
signalfx-agent-66tvr   1/1     Running   0          7s
</code></pre></div></div>
</div>
<p>Ensure there are no errors by tailing the logs from the Smart Agent Pod. Output should look similar to the log output shown below. Use the label set by the <code>helm</code> install to tail logs (You will need to press Ctrl-C to exit). Or use the installed <code>k9s</code> terminal UI for bonus points!</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Input</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><code>kubectl logs -l <span class="nv">app</span><span class="o">=</span>signalfx-agent -f
</code></pre></div></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Output</label>
<div class="superfences-content"><div class="codehilite"><pre><span></span><code>time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Starting up agent version 5.0.0&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Watching for config file changes&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;New config loaded&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Using log level info&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Fetching host id dimensions&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Trying to get fully qualified hostname&quot;
time=&quot;2020-03-15T11:30:28Z&quot; level=info msg=&quot;Using hostname PH-k3s&quot;
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Using host id dimensions map[host:PH-k3s    kubernetes_node_uid:05ba9d7b-89d4-4c70-a3e9-4dc72923423a]&quot;
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Sending datapoints to https://ingest.us1.signalfx.com/v2/datapoint&quot;
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Sending events to https://ingest.us1.signalfx.com/v2/event&quot;
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Creating new monitor&quot; discoveryRule= monitorID=10 monitorType=kubelet-stats
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Creating new monitor&quot; discoveryRule= monitorID=11 monitorType=kubernetes-cluster
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Done configuring agent&quot;
...
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Serving internal metrics at localhost:8095&quot;
   I0315 11:30:29.922577       1 leaderelection.go:242] attempting to acquire leader lease  default/signalfx-agent-leader...
   I0315 11:30:29.950448       1 leaderelection.go:252] successfully acquired lease default/signalfx-agent-leader
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;K8s leader is now node ph-k3s&quot;
time=&quot;2020-03-15T11:30:29Z&quot; level=info msg=&quot;Starting K8s API resource sync&quot;
...
</code></pre></div></div>
</div>
<hr />
<h3 id="4-check-all-is-well-in-the-signalfx-ui">4. Check all is well in the SignalFx UI!<a class="headerlink" href="#4-check-all-is-well-in-the-signalfx-ui" title="Permanent link">&para;</a></h3>
<p>In the SignalFx UI, goto <em><strong>INFRASTRUCTURE → Kubernetes Navigator → Cluster Map</strong></em> and open the Kubernetes Navigator Cluster Map to ensure metrics are being sent.</p>
<p><img alt="Selecting the Kubernetes Navigator Map" src="../../images/M1-l4-select-kubenetes-map.jpg" /></p>
<hr />
<p>Validate that your cluster is discovered and shown (In a workshop you can see many more clusters) by finding your cluster by searching for <code>{YOUR_INITIALS}-SFX-WORKSHOP</code>:</p>
<p><img alt="Find Your Cluster" src="../../images/M1-l4-All-clusters.jpg" /></p>
<p>If there are many clusters you can use the dashboard filter to narrow down to your K8s cluster e.g. <code>kubernetes_cluster: {YOUR_INITIALS}-SFX-WORKSHOP</code> or do this by clicking on the blue cross <img alt="blue cross" src="../../images/M1-l4-blue-cross.jpg" /> after selecting your cluster with your mouse.
<img alt="K8S Clusters Filter" src="../../images/M1-l4-Selecting-K3-cluster.jpg" /></p>
<p>To examine the health of your cluster, open the side bar by clicking on the <img alt="side bar button" src="../../images/M1-l4-sidebar-button.jpg" /> button to open the Metrics side bar. Once it is open, you can use the slider on the side to explore the various charts relevant to your cluster/node: Cpu%, Mem%, Network in &amp; out. Events and Container list.</p>
<p><img alt="side bar metrics" src="../../images/M1-l4-explore-metrics.jpg" /></p>
                
                  
                
                
                  
                  <hr>
                  <div class="md-source-date">
                    <small>
                      
                        Last update: April 6, 2020
                      
                    </small>
                  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../muting/" title="Working with Muting Rules" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Working with Muting Rules
              </span>
            </div>
          </a>
        
        
          <a href="../nginx/" title="Deploying NGINX in K3s" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Deploying NGINX in K3s
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 Splunk Inc. All rights reserved.
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>