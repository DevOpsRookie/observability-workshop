<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This workshop is going to take you through the exciting journey of App Dev, what this is, why this is important, and how to get started right away!"><link href=https://signalfx.github.io/app-dev-workshop/module7/vo_integrations/ rel=canonical><meta name=author content="Sales Engineering"><link rel="shortcut icon" href=../../images/favicon.ico><meta name=generator content="mkdocs-1.1, mkdocs-material-5.1.1"><title>VictorOps Integrations - Splunk App Dev Workshop</title><link rel=stylesheet href=../../assets/stylesheets/main.a676eddb.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.b302131d.min.css><meta name=theme-color content><link href=https://fonts.gstatic.com rel=preconnect crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../extra.css></head> <body dir=ltr data-md-color-primary=black data-md-color-accent> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#victorops-integrations-lab-summary class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://signalfx.github.io/app-dev-workshop/ title="Splunk App Dev Workshop" class="md-header-nav__button md-logo" aria-label="Splunk App Dev Workshop"> <img src=../../images/logo.png alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z /></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <span class="md-header-nav__topic md-ellipsis"> Splunk App Dev Workshop </span> <span class="md-header-nav__topic md-ellipsis"> VictorOps Integrations </span> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z /></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Type to start searching </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://signalfx.github.io/app-dev-workshop/ title="Splunk App Dev Workshop" class="md-nav__button md-logo" aria-label="Splunk App Dev Workshop"> <img src=../../images/logo.png alt=logo> </a> Splunk App Dev Workshop </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. title=Home class=md-nav__link> <b>Home</b> </a> </li> <li class=md-nav__item> <a href=../../introduction/ title=Introduction class=md-nav__link> <b>Introduction</b> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> <b>Module 1</b> - Dashboards <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 1</b> - Dashboards" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 1</b> - Dashboards </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module1/dashboards/ title="Working with Dashboards, Charts and Metrics" class=md-nav__link> Working with Dashboards, Charts and Metrics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> <b>Module 2</b> - Detectors <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 2</b> - Detectors" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 2</b> - Detectors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module2/detectors/ title="Working with Detectors" class=md-nav__link> Working with Detectors </a> </li> <li class=md-nav__item> <a href=../../module2/muting/ title="Working with Muting Rules" class=md-nav__link> Working with Muting Rules </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-5 type=checkbox id=nav-5> <label class=md-nav__link for=nav-5> <b>Module 3</b> - Smart Agent <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 3</b> - Smart Agent" data-md-level=1> <label class=md-nav__title for=nav-5> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 3</b> - Smart Agent </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module3/prep/ title=Preparation class=md-nav__link> Preparation </a> </li> <li class=md-nav__item> <a href=../../module3/vm/ title="Deploying the Smart Agent on a VM" class=md-nav__link> Deploying the Smart Agent on a VM </a> </li> <li class=md-nav__item> <a href=../../module3/k3s/ title="Deploying the Smart Agent in Kubernetes (K3s)" class=md-nav__link> Deploying the Smart Agent in Kubernetes (K3s) </a> </li> <li class=md-nav__item> <a href=../../module3/nginx/ title="Deploying NGINX in K3s" class=md-nav__link> Deploying NGINX in K3s </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-6 type=checkbox id=nav-6> <label class=md-nav__link for=nav-6> <b>Module 4</b> - Monitoring as Code <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 4</b> - Monitoring as Code" data-md-level=1> <label class=md-nav__title for=nav-6> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 4</b> - Monitoring as Code </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module4/terraform/ title="Using Terraform for charts and dashboards" class=md-nav__link> Using Terraform for charts and dashboards </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-7 type=checkbox id=nav-7> <label class=md-nav__link for=nav-7> <b>Module 5</b> - Service Bureau <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 5</b> - Service Bureau" data-md-level=1> <label class=md-nav__title for=nav-7> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 5</b> - Service Bureau </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module5/service_bureau/ title="Billing and Usage" class=md-nav__link> Billing and Usage </a> </li> <li class=md-nav__item> <a href=../../module5/teams/ title=Teams class=md-nav__link> Teams </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-8 type=checkbox id=nav-8> <label class=md-nav__link for=nav-8> <b>Module 6</b> - µAPM <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 6</b> - µAPM" data-md-level=1> <label class=md-nav__title for=nav-8> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 6</b> - µAPM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module6/ title="µAPM Architecture Overview" class=md-nav__link> µAPM Architecture Overview </a> </li> <li class=md-nav__item> <a href=../../module6/hotrod/ title="Deploying Hot R.O.D. in K3s" class=md-nav__link> Deploying Hot R.O.D. in K3s </a> </li> <li class=md-nav__item> <a href=../../module6/sockshop/ title="Deploying Sock Shop in K3s" class=md-nav__link> Deploying Sock Shop in K3s </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-9 type=checkbox id=nav-9 checked> <label class=md-nav__link for=nav-9> <b>Module 7</b> - VictorOps <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Module 7</b> - VictorOps" data-md-level=1> <label class=md-nav__title for=nav-9> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Module 7</b> - VictorOps </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../vo_getting_started/ title="VictorOps Getting Started" class=md-nav__link> VictorOps Getting Started </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> VictorOps Integrations <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z /></svg> </span> </label> <a href=./ title="VictorOps Integrations" class="md-nav__link md-nav__link--active"> VictorOps Integrations </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#1-configuring-the-integration-between-victorops-and-signalfx class=md-nav__link> 1. Configuring the Integration between VictorOps and SignalFx </a> <nav class=md-nav aria-label="1. Configuring the Integration between VictorOps and SignalFx"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-victorops-service-api-endpoint class=md-nav__link> 1.1. VictorOps Service API Endpoint </a> </li> <li class=md-nav__item> <a href=#12-enable-victorops-integration-within-signalfx class=md-nav__link> 1.2. Enable VictorOps Integration within SignalFx </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-creating-a-test-environment class=md-nav__link> 2. Creating a Test Environment </a> <nav class=md-nav aria-label="2. Creating a Test Environment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-multipass class=md-nav__link> 2.1. Multipass </a> </li> <li class=md-nav__item> <a href=#22-signalfx-details class=md-nav__link> 2.2. SignalFx Details </a> </li> <li class=md-nav__item> <a href=#23-local-vms-using-multipass class=md-nav__link> 2.3. Local VMs using Multipass </a> </li> <li class=md-nav__item> <a href=#24-signalfx-detector class=md-nav__link> 2.4. SignalFx Detector </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../vo_incident_lifecycle/ title="VictorOps Incident Lifecycle" class=md-nav__link> VictorOps Incident Lifecycle </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../module-support/cleanup/ title="Post Workshop Clean Up!" class=md-nav__link> <b>Post Workshop Clean Up!</b> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-11 type=checkbox id=nav-11> <label class=md-nav__link for=nav-11> <b>Optional Modules</b> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z /></svg> </span> </label> <nav class=md-nav aria-label="<b>Optional Modules</b>" data-md-level=1> <label class=md-nav__title for=nav-11> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> <b>Optional Modules</b> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../module8/hotrod-eks/ title="Deploying Hot R.O.D. in EKS" class=md-nav__link> Deploying Hot R.O.D. in EKS </a> </li> <li class=md-nav__item> <a href=../../module-support/ec2-setup/ title="Creating an AWS/EC2 instance" class=md-nav__link> Creating an AWS/EC2 instance </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#1-configuring-the-integration-between-victorops-and-signalfx class=md-nav__link> 1. Configuring the Integration between VictorOps and SignalFx </a> <nav class=md-nav aria-label="1. Configuring the Integration between VictorOps and SignalFx"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#11-victorops-service-api-endpoint class=md-nav__link> 1.1. VictorOps Service API Endpoint </a> </li> <li class=md-nav__item> <a href=#12-enable-victorops-integration-within-signalfx class=md-nav__link> 1.2. Enable VictorOps Integration within SignalFx </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#2-creating-a-test-environment class=md-nav__link> 2. Creating a Test Environment </a> <nav class=md-nav aria-label="2. Creating a Test Environment"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-multipass class=md-nav__link> 2.1. Multipass </a> </li> <li class=md-nav__item> <a href=#22-signalfx-details class=md-nav__link> 2.2. SignalFx Details </a> </li> <li class=md-nav__item> <a href=#23-local-vms-using-multipass class=md-nav__link> 2.3. Local VMs using Multipass </a> </li> <li class=md-nav__item> <a href=#24-signalfx-detector class=md-nav__link> 2.4. SignalFx Detector </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=victorops-integrations-lab-summary>VictorOps Integrations - Lab Summary<a class=headerlink href=#victorops-integrations-lab-summary title="Permanent link">&para;</a></h1> <ol> <li>Configuring the Integration between VictorOps and SignalFx</li> <li>Creating a test environment using Multipass</li> </ol> <hr> <p>You are going to need to record a number of values during this module which we will export as variables in a later step so I suggest you create a <code>values document</code> to store the following values as you work through it.</p> <div class=tabbed-set data-tabs=1:1><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Values</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>SFXVOPSID</span><span class=o>=</span>
<span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>
<span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span>
<span class=nb>export</span> <span class=nv>ROUTINGKEY</span><span class=o>=</span>
<span class=nb>export</span> <span class=nv>INITIALS</span><span class=o>=</span>

<span class=nv>Service_API_Endpoint</span><span class=o>=</span>
</code></pre></div> </div> </div> <hr> <h2 id=1-configuring-the-integration-between-victorops-and-signalfx>1. Configuring the Integration between VictorOps and SignalFx<a class=headerlink href=#1-configuring-the-integration-between-victorops-and-signalfx title="Permanent link">&para;</a></h2> <h3 id=11-victorops-service-api-endpoint>1.1. VictorOps Service API Endpoint<a class=headerlink href=#11-victorops-service-api-endpoint title="Permanent link">&para;</a></h3> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>The SignalFx Integration only needs to be enabled once per VictorOps instance, so you will probably find it has already been enabled, please <strong>DO NOT</strong> disable an already active integration when completing this lab.</p> </div> <p>In order to integrate SignalFx with VictorOps we need to first obtain the Service API Endpoint for VictorOps. Within the VictorOps UI navigate to <code>Integrations</code> main tab and then use the search feature to find the SignalFx Integration. If it is not already enabled, click the Enable Integration button to activate it.</p> <p>You simply need to copy the Service API Endpoint, including the <code>$routing_key</code> into your <code>values document</code> using the <code>Service_API_Endpoint</code> parameter. This will be used when configuring the VictorOps Integration within the SignalFx UI.</p> <h3 id=12-enable-victorops-integration-within-signalfx>1.2. Enable VictorOps Integration within SignalFx<a class=headerlink href=#12-enable-victorops-integration-within-signalfx title="Permanent link">&para;</a></h3> <p>Login to your SignalFx account and navigate to Integrations and use the search feature to find the VictorOps integration. Assuming you are using the AppDev EMEA instance of VictorOps you will find the VictorOps Integration has already been configured so there is no need to create a new one.</p> <p>However the process of creating a new Integration is simply to click on <code>Create New Integration</code> like in the image below, or if there are existing integrations and you want to add another one you would click <code>New Integration</code>.</p> <p><img alt="VictorOps Integration" src=../../images/module7/m7-sfx-new-vo-integration.png></p> <p>...give it a descriptive <code>Name</code> then paste the <code>Service_API_Endpoint</code> value you copied in the previous step into the <code>Post URL</code> field, then save it.</p> <p><img alt="VictorOps Integration" src=../../images/module7/m7-sfx-vo-integration-url.png></p> <div class="admonition important"> <p class=admonition-title>Important</p> <p>SignalFx can integrate with multiple VictorOps accounts so it is important when creating one to use a descriptive name and to not simply call it VictorOps. This name will be used within the SignalFx UI when selecting this integration, so ensure it is unambiguous</p> </div> <p>Once saved you need to copy the ID and save it in your <code>values document</code> using the <code>SFXVOPSID</code> parameter for use later in the module.</p> <p><img alt="VictorOps Integration" src=../../images/module7/m7-sfx-vo-integration-id.png></p> <div class="admonition warning"> <p class=admonition-title>Warning</p> <p>Please do not create additional VictorOps integrations if one already exists, it will not break anything but simply creates extra clean up work after the workshop has completed. The aim of this part of the lab was to show you how you would go about configuring the Integration if it was not already enabled.</p> </div> <h2 id=2-creating-a-test-environment>2. Creating a Test Environment<a class=headerlink href=#2-creating-a-test-environment title="Permanent link">&para;</a></h2> <h3 id=21-multipass>2.1. Multipass<a class=headerlink href=#21-multipass title="Permanent link">&para;</a></h3> <p>The easiest way to test VictorOps is to use Multipass to run some local test VMs which will be monitored by SignalFx.</p> <p>If you do not already have Multipass installed you can download the installer from <a href=https://multipass.run/ >here</a>. Mac OS users can install it using Homebrew by running:</p> <div class=tabbed-set data-tabs=2:1><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>Code</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>brew cask install multipass
</code></pre></div> </div> </div> <h3 id=22-signalfx-details>2.2. SignalFx Details<a class=headerlink href=#22-signalfx-details title="Permanent link">&para;</a></h3> <p>We will use cloud-init to install the SignalFx Agent into the VMs but we first need to obtain the <code>Token</code> and <code>Realm</code> from your SignalFx account.</p> <p>You can find your Access Token by clicking on the <code>settings</code> icon on the top right of the SignalFx UI, select <code>Organization Settings</code> → <code>Access Tokens</code>, expand the Default token, then click on <code>Show Token</code> to expose your token, click the <code>Copy</code> button to copy it to your clipboard, then paste it into your <code>values document</code> using the <code>ACCESS_TOKEN</code> parameter.</p> <p><img alt="Access Token" src=../../images/module7/m7-access-token.png></p> <p>You will also need to obtain the name of the Realm for your SignalFx account. Click on the <code>account</code> icon again, but this time select <code>My Profile</code>. The Ream can be found in the middle of the page within the Organizations section. In this example it is <code>us1</code>. Again, make a note of this in your <code>values document</code> using the <code>REALM</code> parameter.</p> <p><img alt=Realm src=../../images/module7/m7-realm.png></p> <h3 id=23-local-vms-using-multipass>2.3. Local VMs using Multipass<a class=headerlink href=#23-local-vms-using-multipass title="Permanent link">&para;</a></h3> <p>The next step is to create a cloud-init file that will automatically install the SignalFx Agent when the VMs are created. Create a <code>victorops.yaml</code> file using your preferred editor and populate it with the following, but replacing &lt;YOUR REALM&gt; &amp; &lt;YOUR TOKEN&gt; with the values stored in your <code>values document</code>.</p> <div class=tabbed-set data-tabs=3:1><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>victorops.yaml</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=c1>#cloud-config</span>
package_update: <span class=nb>true</span>
package_upgrade: <span class=nb>true</span>

runcmd:
- curl -sSL https://dl.signalfx.com/signalfx-agent.sh &gt; /tmp/signalfx-agent.sh
- sudo sh /tmp/signalfx-agent.sh --realm &lt;YOUR REALM&gt; &lt;YOUR TOKEN&gt;
</code></pre></div> </div> </div> <p>With the <code>victorops.yaml</code> file created, from the same directory where you created it run the following commands to create two VMs. As in other modules prefix the name of each VM with your initials to make them unique within your SignalFx account. You may also want to first shutdown any other VMs you still have running from previous modules to free up resources.</p> <div class="admonition tip"> <p class=admonition-title>Tip</p> <p>Use two terminal windows to create the two VMs in parallel</p> </div> <p>1st VictorOps VM</p> <div class=tabbed-set data-tabs=4:2><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><label for=__tabbed_4_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>multipass launch <span class=se>\</span>
--name &lt;YOUR INITIALS&gt;-vo1 <span class=se>\</span>
--cloud-init victorops.yaml <span class=se>\</span>
--cpus<span class=o>=</span><span class=m>1</span> --disk<span class=o>=</span>2G --mem<span class=o>=</span>1G
</code></pre></div> </div> <input id=__tabbed_4_2 name=__tabbed_4 type=radio><label for=__tabbed_4_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>multipass launch \
--name gh-vo1 \
--cloud-init victorops.yaml \
--cpus=1 --disk=2G --mem=1G
Launched: gh-vo1
</code></pre></div> </div> </div> <p>2nd VictorOps VM</p> <div class=tabbed-set data-tabs=5:2><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><label for=__tabbed_5_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>multipass launch <span class=se>\</span>
--name &lt;YOUR INITIALS&gt;-vo2 <span class=se>\</span>
--cloud-init victorops.yaml <span class=se>\</span>
--cpus<span class=o>=</span><span class=m>1</span> --disk<span class=o>=</span>2G --mem<span class=o>=</span>1G
</code></pre></div> </div> <input id=__tabbed_5_2 name=__tabbed_5 type=radio><label for=__tabbed_5_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>multipass launch \
--name gh-vo2 \
--cloud-init victorops.yaml \
--cpus=1 --disk=2G --mem=1G
Launched: gh-vo2
</code></pre></div> </div> </div> <p>Once your two VMs have been created check within the SignalFx UI, Infrastructure Tab, and confirm they are reporting in correctly. Allow a couple or minutes for the VMs to spin up, install updates and then install the SignalFx Agent etc.</p> <p>If they fail to appear, double check your Token and Realm settings within your victorops.yaml file. If errors are found these can easily be updated directly within the VM. Simply update the <code>token</code> or <code>api_url</code> and <code>ingest_url</code> files located within <code>/etc/signalfx</code>.</p> <h3 id=24-signalfx-detector>2.4. SignalFx Detector<a class=headerlink href=#24-signalfx-detector title="Permanent link">&para;</a></h3> <p>We now need to create a new Detector within SignalFx which will use VictorOps as the target to send alerts to. We will use Terraform to create the detector in a similar way to 'Module 4 - Monitoring as Code'.</p> <p>If you have not completed Module 4, and do not have Terraform already installed, download and install it for your platform - <code>https://www.terraform.io/downloads.html</code> (min. requirement v. 0.12.18)</p> <p>Copy and run the following code to download the VictorOps Workshop Detectors master zip file, unzip the file, then change into the <code>victorops-workshop-detectors-master</code> directory.</p> <div class=tabbed-set data-tabs=6:2><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><label for=__tabbed_6_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>curl -LO https://github.com/signalfx/victorops-workshop-detectors/archive/master.zip
unzip master.zip
<span class=nb>cd</span> victorops-workshop-detectors-master
</code></pre></div> </div> <input id=__tabbed_6_2 name=__tabbed_6 type=radio><label for=__tabbed_6_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   142  100   142    0     0    459      0 --:--:-- --:--:-- --:--:--   459
100  4007    0  4007    0     0   5466      0 --:--:-- --:--:-- --:--:-- 17197
Archive:  master.zip
fcc95b101225ddb876d16106b5d7ece74a41f6c1
   creating: victorops-workshop-detectors-master/
  inflating: victorops-workshop-detectors-master/.DS_Store
  inflating: victorops-workshop-detectors-master/.gitignore
  inflating: victorops-workshop-detectors-master/README.md
  inflating: victorops-workshop-detectors-master/main.tf
   creating: victorops-workshop-detectors-master/modules/
  inflating: victorops-workshop-detectors-master/modules/.DS_Store
   creating: victorops-workshop-detectors-master/modules/host/
  inflating: victorops-workshop-detectors-master/modules/host/cpu.tf
  inflating: victorops-workshop-detectors-master/modules/host/variables.tf
  inflating: victorops-workshop-detectors-master/variables.tf
 extracting: victorops-workshop-detectors-master/versions.tf
➜  victorops-workshop-detectors-master
</code></pre></div> </div> </div> <p>Create the following environment variables to use in the Terraform steps below. The 1st three variables should be stored in your <code>values document</code> if you have been populating it as you have worked through this module. You can populate the final two now then simply copy all five lines into your terminal window where you downloaded the terraform files in the previous step.</p> <div class=tabbed-set data-tabs=7:2><input checked=checked id=__tabbed_7_1 name=__tabbed_7 type=radio><label for=__tabbed_7_1>Variables</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>SFXVOPSID</span><span class=o>=</span>&lt;VictorOps Integration ID from Step <span class=m>2</span>&gt;
<span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;SignalFx Access Token from Step <span class=m>2</span>&gt;
<span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span>&lt;SignalFx Realm from Step <span class=m>2</span>&gt;
<span class=nb>export</span> <span class=nv>ROUTINGKEY</span><span class=o>=</span>&lt;YOUR_INITIALS&gt;_PRI
<span class=nb>export</span> <span class=nv>INITIALS</span><span class=o>=</span>&lt;YOUR_INITIALS&gt;
</code></pre></div> </div> <input id=__tabbed_7_2 name=__tabbed_7 type=radio><label for=__tabbed_7_2>Example</label><div class=tabbed-content> <div class=highlight><pre><span></span><code><span class=nb>export</span> <span class=nv>SFXVOPSID</span><span class=o>=</span>xxxxxxxxxxxx
<span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>xxxxxxxxxxxxxxx
<span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span>us1
<span class=nb>export</span> <span class=nv>ROUTINGKEY</span><span class=o>=</span>GH_PRI
<span class=nb>export</span> <span class=nv>INITIALS</span><span class=o>=</span>GH
</code></pre></div> </div> </div> <p>Initialize Terraform.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>You will need to run this command each time a new version of the Terraform Provider is released. You can track the releases on <a href=https://github.com/terraform-providers/terraform-provider-signalfx/releases>GitHub</a>.</p> </div> <div class=tabbed-set data-tabs=8:2><input checked=checked id=__tabbed_8_1 name=__tabbed_8 type=radio><label for=__tabbed_8_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>terraform init -upgrade
</code></pre></div> </div> <input id=__tabbed_8_2 name=__tabbed_8 type=radio><label for=__tabbed_8_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>Upgrading modules...
- host in modules/host

Initializing the backend...

Initializing provider plugins...
- Checking for available provider plugins...
- Downloading plugin for provider &quot;signalfx&quot; (terraform-providers/signalfx) 4.19.1...

The following providers do not have any version constraints in configuration,
so the latest version was installed.

To prevent automatic upgrades to new major versions that may contain breaking
changes, it is recommended to add version = &quot;...&quot; constraints to the
corresponding provider blocks in configuration, with the constraint strings
suggested below.

* provider.signalfx: version = &quot;~&gt; 4.19&quot;

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running &quot;terraform plan&quot; to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.
</code></pre></div> </div> </div> <p>Create a new Terraform Workspace which will track the state for this environment. Workspaces allow you to run Terraform against different environments each with their own state data stored in the workspace. In the following example we create a workspace called 'Workshop' but feel free to use whatever name you like.</p> <div class=tabbed-set data-tabs=9:2><input checked=checked id=__tabbed_9_1 name=__tabbed_9 type=radio><label for=__tabbed_9_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>terraform workspace new Workshop
</code></pre></div> </div> <input id=__tabbed_9_2 name=__tabbed_9 type=radio><label for=__tabbed_9_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>Created and switched to workspace &quot;Workshop&quot;!

You&#39;re now on a new, empty workspace. Workspaces isolate their state,
so if you run &quot;terraform plan&quot; Terraform will not see any existing state
for this configuration.
</code></pre></div> </div> </div> <p>It is considered best practice to run a terraform plan to see what changes may get made and check for potential errors before running an apply as we did in Module 4, however as the first stage of apply is to plan we can safely skip that step and just run apply. Check the plan output for errors before typing <em><strong>yes</strong></em> to commit the apply.</p> <div class=tabbed-set data-tabs=10:2><input checked=checked id=__tabbed_10_1 name=__tabbed_10 type=radio><label for=__tabbed_10_1>Input</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>terraform apply -var=&quot;access_token=$ACCESS_TOKEN&quot; -var=&quot;realm=$REALM&quot; -var=&quot;sfx_prefix=$INITIALS&quot; -var=&quot;sfx_vo_id=$SFXVOPSID&quot; -var=&quot;routing_key=$ROUTINGKEY&quot;
</code></pre></div> </div> <input id=__tabbed_10_2 name=__tabbed_10 type=radio><label for=__tabbed_10_2>Output</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
  + create

Terraform will perform the following actions:

  # module.host.signalfx_detector.cpu_greater_90 will be created
  + resource &quot;signalfx_detector&quot; &quot;cpu_greater_90&quot; {
      + description       = &quot;Alerts when CPU usage is greater than 90%&quot;
      + id                = (known after apply)
      + max_delay         = 0
      + name              = &quot;GH CPU greater than 90%&quot;
      + program_text      = &lt;&lt;~EOT
            from signalfx.detectors.against_recent import against_recent
            A = data(&#39;cpu.utilization&#39;).publish(label=&#39;A&#39;)
            detect(when(A &gt; threshold(90))).publish(&#39;CPU utilization is greater than 90%&#39;)
        EOT
      + show_data_markers = true
      + time_range        = 3600
      + url               = (known after apply)

      + rule {
          + detect_label          = &quot;CPU utilization is greater than 90%&quot;
          + disabled              = false
          + notifications         = [
              + &quot;VictorOps,ERI0R2GAIAA,GH_PRI&quot;,
            ]
          + parameterized_body    = &lt;&lt;~EOT
                {{#if anomalous}}
                 Rule &quot;{{{ruleName}}}&quot; in detector &quot;{{{detectorName}}}&quot; triggered at {{timestamp}}.
                {{else}}
                 Rule &quot;{{{ruleName}}}&quot; in detector &quot;{{{detectorName}}}&quot; cleared at {{timestamp}}.
                {{/if}}

                {{#if anomalous}}
                  Triggering condition: {{{readableRule}}}
                {{/if}}

                {{#if anomalous}}
                  Signal value: {{inputs.A.value}}
                {{else}}
                  Current signal value: {{inputs.A.value}}
                {{/if}}

                {{#notEmpty dimensions}}
                  Signal details: {{{dimensions}}}
                {{/notEmpty}}

                {{#if anomalous}}
                  {{#if runbookUrl}}
                    Runbook: {{{runbookUrl}}}
                  {{/if}}
                  {{#if tip}}
                    Tip: {{{tip}}}
                  {{/if}}
                {{/if}}
            EOT
          + parameterized_subject = &quot;{{ruleSeverity}} Alert: {{{ruleName}}} ({{{detectorName}}})&quot;
          + severity              = &quot;Warning&quot;
        }
    }

Plan: 1 to add, 0 to change, 0 to destroy.

Do you want to perform these actions in workspace &quot;Workshop&quot;?
  Terraform will perform the actions described above.
  Only &#39;yes&#39; will be accepted to approve.

  Enter a value: yes

module.host.signalfx_detector.cpu_greater_90: Creating...
module.host.signalfx_detector.cpu_greater_90: Creation complete after 2s [id=EWHU-YAAAAA]

Apply complete! Resources: 1 added, 0 changed, 0 destroyed.
</code></pre></div> </div> </div> <hr> <p>You have now configured the Integrations between VictorOps and SignalFx so the final part of this module is to test the flow of alerts from SignalFx into VictorOps and see how you can manage the incident with both the VictorOps UI and Mobile App.</p> <hr> <div class=md-source-date> <small> Last update: April 22, 2020 15:43:48 </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class=md-footer-nav> <nav class="md-footer-nav__inner md-grid" aria-label=Footer> <a href=../vo_getting_started/ title="VictorOps Getting Started" class="md-footer-nav__link md-footer-nav__link--prev" rel=prev> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z /></svg> </div> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Previous </span> VictorOps Getting Started </div> </div> </a> <a href=../vo_incident_lifecycle/ title="VictorOps Incident Lifecycle" class="md-footer-nav__link md-footer-nav__link--next" rel=next> <div class=md-footer-nav__title> <div class=md-ellipsis> <span class=md-footer-nav__direction> Next </span> VictorOps Incident Lifecycle </div> </div> <div class="md-footer-nav__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d=M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z /></svg> </div> </a> </nav> </div> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Splunk Inc. All rights reserved. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.c51dfa35.min.js></script> <script src=../../assets/javascripts/bundle.eaaa3931.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script> <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> </body> </html>